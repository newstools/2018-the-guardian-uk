Despite repeatedly embarrassing the British prime minister at a politically bruising G7 summit in Quebec, Donald Trump’s controversial visit to the UK next month would still appear to be on. Theresa May insisted that she had exchanged warm greetings with the US president and he had said how much he was “looking forward” to his visit. “We have a very good relationship with President Trump,” she said, after she had been challenged on his reported remarks that she was schoolmistressy and politically correct. “We work closely with President Trump, and the UK has a very good relationship with the United States,” she said, defending his decision to leave early in order to prepare for his summit with Kim Jong-un. “He’s going to Singapore to sit down and discuss the denuclearisation of North Korea ... that is in the interests of all of us across the world.” May said that the fact that the G7 had managed to reach an 11th-hour agreement on all the main topics under consideration, including not readmitting Russia and a form of words on trade, was a victory for international cooperation. “We had some difficult conversations and some strong debate,” she said at the end of two days’ of impassioned argument vividly captured in an image of six of the G7 leaders confronting an isolated Trump. The US president had sat defiantly in front of them as they argued over the final communique at an impromptu session over the breakfast table on Saturday morning. But her anger at the presidential slights, which included omitting her from a list of G7 leaders he had a strong relationship with, was evident when she issued a clear reprimand about his attitude to global cooperation. “It does not mean taking unilateral action against your partners”, she said. “Where we disagree ... you air the action openly and frankly. We have done just that.” On Friday night, it looked as if it would be impossible to reach an agreed text, with the US blocking agreement on trade and on one of the summit’s main objectives, reaching agreement on tackling ocean plastics. But after an all-night session by the sherpas – the personal representative of each of the heads of state or governments – a communique acknowledging that globalisation left some people behind, and allowing both the US and Japan to negotiate a separate plan to tackle ocean plastics, was agreed in time for the final session. However, Trump’s own closing press conference a few hours later revealed how far apart the two sides were. Like the other EU leaders, May was looking for some sign that the US president might reconsider his tariffs on steel and aluminium. And she hoped for public buy-in to her ambitious project for a rapid response unit to tackle hostile state activity. Instead he arrived at the summit late and left early, after demanding again that Russia be readmitted to the forum, leaving after a verbal rampage through the wreckage of the rules based world order at a closing news conference. “It’s not a question of, ‘I hope it will change’”, he warned his fellow G7 members on trade relations. “It’s going to change, 100%. Tariffs are going to come way down because people cannot continue to do that. We’re like the piggy bank that everybody’s robbing. And that ends.” He angrily warned the EU – set to bring in £2.5bn worth of tariffs against the US at the beginning of July – against further tit-for-tat tariffs, telling them there would only be one winner. “There’s very bad spirit when we have a big trade imbalance and they keep raising it so we never catch up,” he said. “That’s not a good thing to do. And we have very, very strong measures that take care of that ... the numbers are so astronomically against them ... we win that war a thousand times out of a thousand.” Trump also failed to namecheck May when referencing G7 leaders as he ran through events of the past two days. “I’d say the level of relationship is a 10. We have a great relationship. Angela [Merkel], and Emmanuel [Macron] and Justin [Trudeau] ... I would say the relationship is a 10.” May’s officials have been arguing that despite the pre-summit reports of Trump struggling with her “schoolmistressy” style and her “political correctness”, he always listened to her carefully. May now flies back to face a week that includes what will almost certainly be a tense meeting of Conservatives backbenchers and two days of debates and votes on the EU withdrawal bill, which will be a defining moment in the UK’s passage out of the EU. She warned rebels on the bill not to risk frustrating its passage. “It is an important and key building block in the process of leaving the European Union and I would hope that everybody across the House of Commons will see the importance of ensuring that that bill is not frustrated,” she said. “At its core, it’s about delivering to the British public on their vote to leave the EU.”