European leaders have papered over the divisions on migration with a promise that some EU countries would take in migrants rescued from the Mediterranean sea, after marathon talks at an EU summit lasting nearly 10 hours. Announcing the end of tense summit talks shortly before dawn, the head of the European council, Donald Tusk, tweeted that EU leaders had reached an agreement, including on migration. Hours earlier that outcome had been in doubt, when Italy threatened to veto the entire text unless other EU states did more to help with people arriving on Italian shores. Opposition from Poland, Hungary and other central European states to any hint of mandatory action meant talks dragged through the night. The euro jumped 0.6% on news of the deal, while the French president, Emmanuel Macron, declared that European cooperation “has won the day”. Italy’s prime minister, Giuseppe Conte, said: “We are satisfied. It was a long negotiation but from today Italy is no longer alone.” But the bloc dodged an agreement on controversial refugee quotas, as a quartet of central European countries resisted language on EU-wide responsibility. The outcome is already being seen as a thin deal. It is also unclear whether Angela Merkel has a deal that will secure the future of her coalition government, which has been rocked by disputes over handling refugees.Allies of the German chancellor on Friday morning praised the outcome of the meeting in the highest notes.Günther Oettinger, the European commissioner for budget and human resources, hailed the outcome of the summit as a “genuine breakthrough”. “I believe there are good reasons why the CSU will recognise this as big step in the right direction”, Oettinger told German radio. “We in the CDU will recognise it as a big step in the right direction”. On leaving the summit, the German chancellor conceded that “we still have a lot of work to do to bridge the different views”, but said it was “a good signal” that the EU had agreed a common text. Merkel had warned on Thursday that the future of the European Union hinged on whether it could find answers to the “vital questions” posed by migration. Leaders agreed EU countries should help migrants rescued in the Mediterranean to alleviate the burden on Italy and Greece, but the details remained unclear. The issue has risen to the fore, since Italy closed its ports to migrant rescue ships, leaving several boats adrift at sea, until other countries stepped in to help. In an effort to avoid a chaotic situation, leaders agreed there should be “a shared effort”, but “only on a voluntary basis”. Countries will take in rescued migrants and establish processing centres to assess asylum claims on their soil. In an attempt to force the issue, Italy’s Conte was accused of hijacking the summit when he threatened to block the entire summit conclusions unless he received more help. “I am a law professor,” Conte told his fellow leaders, protesting about the EU’s working methods, promoting an unusual exchange, according to a source. The Bulgarian prime minister, Boyko Borissov, replied: “Well, I used to be a fireman and this is not how you negotiate.” Sweden’s prime minister, Stefan Löfven, added that he used to be a welder and he did not agree with the Italian’s way of making his point either. The summit exposed Europe’s longstanding divisions on migration between central Europe, which refuses to take any refugees, versus western countries, which are seeking “solidarity” even in a token way. Finding a more consensual note, EU leaders called for migrant processing centres in north African countries. They agreed to “swiftly explore the concept of regional platforms in close cooperation” with non-EU countries and the UN refugee agency and the International Organisation for Migration, also a UN-backed agency. In essence, this means migrant processing centres in countries such as Algeria, Egypt, Libya, Morocco, Niger and Tunisia. EU funds would be available to persuade countries to sign on, but so far no countries have agreed, while a couple have ruled themselves out. In a sign of the political complexities involved, the UN agency vision for the scheme clashes with those of some EU leaders, who put the accent on closing borders and stopping arrivals. Hungary’s leader, Viktor Orbán, called for a “strong border” to stop what he called an “invasion” of migrants. In contrast, the UNHCR/IOM paper seen by the Guardian calls for “strong leadership from European Union member states on upholding the right to asylum and the rights of migrants”, while stressing that the EU could not outsource the problem. “The idea is really not us and them, either Europe or North Africa,” Eugenio Ambrosi, Europe director for the International Organization for Migration, told the Guardian. “It is a Mediterranean approach that is shared by those countries that are willing.” “What we do not want is external processing centres and we definitely do not want an Australian model,” he said, referring to controversial detention centres on Pacific islands. Conte said his government had not decided whether to set up a migrant processing centre and had not been urged to do so. But the first test from the summit may be for Merkel, who needs to convince her conservative coalition partners that she has a way to control migrants travelling to Germany from southern countries. Germany’s hardline interior minister Horst Seehofer, who is also the leader of the CSU, has threatened to close Germany’s borders to refugees unless Merkel comes up with a plan by 1 July. This has prompted fears that closing Germany’s frontier would lead to a domino effect of closures, destroying the border-free travel area that underpins jobs and trade. At the summit, EU leaders also agreed to roll over wide-ranging economic sanctions against Russia, an outcome that had been in doubt following the recent election of Italy’s populist government that is more sympathetic to Vladimir Putin of Russia.