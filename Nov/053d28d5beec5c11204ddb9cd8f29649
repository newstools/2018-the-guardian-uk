A federal judge has ruled against the Trump administration’s crackdown on “sanctuary cities” declaring that federal authorities acted unconstitutionally by withholding government grant money to local jurisdictions that offer protections to undocumented people. District judge Edgardo Ramos said Trump’s justice department had a “lack of authority” to deny the grants used by local law enforcement. His ruling cited the tenth amendment to the US constitution, which enshrines the state’s powers outside of federal government. “The separation of powers acts as a check on tyranny and the concentration of power,” Judge Ramos said in his ruling. The order blocks the federal government from withholding any further grant money and instructs the justice department to reissue the funds from last year. The lawsuit was brought by seven states and the city of New York and follows a similar ruling upheld by the ninth circuit of appeals earlier in the year that blocked the administration from denying federal funds to the city of Chicago, another sanctuary jurisdiction. “Today’s decision is a major win for New Yorkers’ public safety,” said New York attorney general Barbara Underwood. The Trump administration simply does not have the right to require state and local police to act as federal immigration agents. The Trump administration’s attempt to withhold these vital funds was nothing more than a political attack at the expense of our public safety.” Trump had issued an order in January 2017 that instructed his attorney general to withhold federal grants to sanctuary cities. The order cited a federal statute which mandates that local authorities cannot, barring local laws, prevent federal agencies from requesting information about an individual’s immigration status. The ruling marks the latest judicial setback for the Trump administration’s hardline crackdown on migrants. Earlier in the month a federal judge in San Francisco blocked a recently issued presidential order that sought to end the right to claim asylum to those who crossed the southern border illegally. The justice department declined to comment on Friday’s ruling.