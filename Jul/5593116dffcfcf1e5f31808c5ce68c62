Theresa May saw off a damaging Commons rebellion on Tuesday as Conservative remainers lost a high-stakes vote on the customs union, giving the prime minister some much-needed breathing space on Brexit before the summer break. She avoided all-out Tory civil war and the wrath of the Eurosceptic wing of her party, which had threatened to launch a leadership challenge, when MPs defeated the proposal by six votes. However, minutes earlier, May suffered her second ever Brexit defeat when the Commons, in an unexpected move, backed calls for the UK to remain under EU medicines regulation. Just 24 hours earlier, the prime minister had caved in to hardline Tory Brexiters by accepting their amendments to the customs bill, infuriating remainer MPs and leaving Eurosceptics convinced they had killed off her Chequers plan. Downing Street sources suggested, however, that the prime minister would be emboldened in her negotiations with Brussels by the result as it showed that she had the backing of parliament. MPs voted 307 to 301 to overturn the rebel amendment to the trade bill under which Britain would be forced to join a customs union with the EU if no agreement were reached on frictionless trade by 21 January 2019. Twelve Tory remainers, led by former ministers Stephen Hammond and Nicky Morgan, backed the proposal, which they claimed offered a safeguard in the event of there being no trade agreement with the EU in the run-up to Brexit on 29 March. Sources claimed more Tory MPs would have rebelled if government whips had not threatened to pull the third reading of the bill and table a no confidence vote in May themselves if the vote was lost, raising the spectre of a general election. A customs union is an agreement by a group of countries, such as the EU, to all apply the same tariffs on imported goods from the rest of the world and, typically, eliminate them entirely for trade within the group. By doing this, they can help avoid the need for costly and time-consuming customs checks during trade between members of the union. Asian shipping containers arriving at Felixstowe or Rotterdam, for example, need only pass through customs once before their contents head to markets all over Europe. Lorries passing between Dover and Calais avoid delay entirely. Customs are not the only checks that count – imports are also scrutinised for conformity with trading standards regulations and security and immigration purposes – but they do play an important role in determining how much friction there is at the border. A strict customs regime at Dover or between Northern Ireland and the Republic of Ireland would lead to delays that will be costly for business and disruptive for travellers. Just-in-time supply chains in industries such as car making could suffer. An Irish peace process built around the principle of entirely unfettered travel between north and south could be jeopardised. Five Labour Brexit-supporting MPs, including one who is suspended, voted alongside the government against the customs “backstop” plan – Kate Hoey, John Mann, Frank Field, Graham Stringer and Kelvin Hopkins – risking the fury of their colleagues for saving the prime minister’s skin. Mann, the MP for Bassetlaw, said: “We need a Brexit deal that prioritises jobs and industry, with a deal that delivers frictionless trade. The Tory remainers’ amendment would have made the likelihood of crashing out with a no deal more likely, not less likely.” The Tory party chair, Brandon Lewis, caused confusion after he voted with the government in both the key votes, despite being paired with deputy Liberal Democrat leader Jo Swinson, who was at home on maternity leave with her three-week-old baby. Government sources suggested that Lewis had entered the voting lobbies in error, prompting a furious response from Swinson, who claimed he had abstained on votes during the course of the afternoon but not in the two crunch votes. She tweeted: “Don’t try any nonsense about a mistake – this is calculated, deliberate breaking of trust by government whips to win at all costs. There’s a word for it – cheating.” In reply to Swinson, Lewis tweeted later: “I’m sorry, Jo. I think it was an honest mistake made by the whips in fast-moving circumstances. I know how important the pair is to everyone, especially new parents, and I apologise.”  In an embarrassing climbdown, Downing Street abandoned its plans to bring forward the summer recess by five days. No 10 sources claimed that the idea had been suggested only because they believed it had the support of Labour, which later backed out. However, it would also have meant that there would be almost no time for Tory MPs to hold a confidence vote in the prime minister if one was called. Tory backbenchers had been furious at being put in the invidious position of having to defend voting for an early break to their constituents, while ministers including the home secretary, Sajid Javid, were understood to be frustrated by the short time it left for them to get through government business. Although the defeat on the medicines amendment, with MPs voting 305 to 301 in favour, was both humiliating and unexpected, it does not impact on the central proposals in May’s Brexit plan. The former minister Phillip Lee, who quit over Brexit last month, tabled the amendment, which he said was vital to ensuring British citizens would continue to get the treatment they needed after leaving the EU. “The European medicines regulatory network partnership makes the process of accessing life-saving new medicines and moving medicines quick and easy. If we leave that partnership, the NHS would get groundbreaking new drugs like those for cancer, dementia and diabetes long after other parts of the world,” he said. Government sources said the UK was seeking to be an active participant in the European Medicines Agency, involving making appropriate financial contribution, and would revisit the issue when the bill reached the House of Lords. In extraordinary scenes in the Commons, the trade minister George Hollingbery engaged in open negotiations with the customs union rebels from the dispatch box, offering them a Lords amendment for a “customs arrangement” backstop if they backed down. Hammond, who tabled the new clause, rejected the compromise, insisting that the government instead accepted his plan and water it down later. Downing Street said that May had been clear that leaving the customs union was necessary to enable trade deals with other countries. One No 10 source said a January deadline could disincentivise Brussels from agreeing a deal before then. But Tory remainers said their proposal was “exactly in line” with the Brexit white paper. Hammond told MPs: “This does not undermine the bill, it keeps it on the road.” Morgan said: “What we are proposing is eminently sensible. It is very clear that in this House there is a majority for a customs union to safeguard businesses and our constituents in future.” After the vote, the shadow international development secretary, Barry Gardiner, said: “The government’s handling of Brexit over the past week has been an utter shambles. We have a prime minister who is in office but not in power. Each day that ministers waste arguing amongst themselves increases the risk of the UK crashing out of Europe without an agreement. “Labour is clear that a new comprehensive customs union with the EU after Brexit is the best way to protect jobs, the economy and to avoid a hard border in Northern Ireland. Theresa May should finally accept that and get on with the job of negotiating for Britain.” Leavers, led by Jacob Rees-Mogg, forced the government on Monday to back four amendments to Brexit legislation, including one intended to scupper May’s plans for a new customs deal. The concession infuriated Tory remainers. May was already debating her next move after No 10 denied that the hardline Brexiters’ changes destroyed her Chequers plan, which had already been facing a precarious path through the Commons. It remains far from clear whether Brussels will accept her plans. The government majority was reduced to three votes on the two most controversial amendments on Monday night.