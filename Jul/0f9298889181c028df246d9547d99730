A long-running siege by Syrian rebels of two pro-regime towns has been lifted after a deal to forcibly displace the entire population in exchange for the release of regime prisoners was completed in the early hours of Thursday. The agreement between Bashar al-Assad’s regime and Hay’at Tahrir al-Sham (HTS), an al-Qaida-linked group, ended a three-year ordeal for people in the towns of Fua and Kefraya but furthered the trend of demographic change and the reshaping of Syria along sectarian and ethnic lines after seven years of civil war. Buses carrying almost 7,000 people departed the towns and arrived near the city of Aleppo, which is controlled by the Assad regime. The completion of the deal was confirmed by the Syrian state news agency Sana and in a statement by HTS. The Syrian Observatory for Human Rights, a war monitor, said the towns had been emptied. HTS said the area would be declared a military zone and, after inspections were completed, would be open for resettlement by refugees fleeing other parts of Syria. In rare examples of sieges imposed by rebel groups in Syria, Fua and Kefraya were first blockaded in 2015 after an offensive that ousted forces loyal to Assad from most of the province of Idlib. Since then the towns’ civilians have suffered from food and medicine shortages. Sieges have been used as a weapon of war most frequently by the Assad regime. The largest siege conducted by the government, of civilians and rebels in the Damascus suburbs of eastern Ghouta, ended three months ago with the capitulation of the opposition. HTS said it had secured the release of 1,500 prisoners held in government prisons and by the Lebanese militia Hezbollah, which is fighting alongside the Assad regime, in exchange for allowing the safe passage of Fua and Kefraya residents. Idlib is the last major chunk of territory controlled by rebels fighting to overthrow Assad, after repeated military defeats by government forces backed by Moscow and Tehran secured the regime’s survival. The momentum in the seven-year war is now decidedly in Assad’s favour, but large parts of the country’s east and north remain outside of the regime’s control, in the hands of American-backed Kurdish militias and Turkish-backed proxy fighters. Idlib is now home to hundreds of thousands of people who have fled the violence in other parts of Syria, sent there after surrender deals forcibly displaced them to the region bordering Turkey. Many fear Idlib will become a killing ground with the conclusion of offensives in other regions of the country, prompting a humanitarian catastrophe. But speculation is rife that a deal reportedly brokered by Russia and Turkey provides protections against a broad military campaign to reclaim the entire province and potentially cause a new wave of refugees fleeing across the border. Syrian state media reported that another deal to end the fighting in the country’s south near the border with the Israeli-occupied Golan Heights was imminent, another step to the government securing complete control over the area and ending the rebellion there. Backed by Russian air power and unopposed by Assad’s foreign adversaries, government forces have swept through southwestern Syria in the last month in one of the swiftest campaigns of the war, forcing surrender on massively outgunned rebels. The campaign, which has already restored Assad’s control over a critical portion of the frontier with Jordan, marks another milestone in his efforts to recover control of the country fractured by more than seven years of conflict. A copy of the agreement sent by a rebel source to the Reuters news agency said insurgents had negotiated the deal with Russia. Echoing surrender terms imposed on rebels elsewhere, those wishing to stay in the area will “settle” their status with the state, meaning accepting a return of its rule. Those who reject the deal will be given safe passage out to the opposition-held province of Idlib.