Czech communists have savoured their first taste of power in nearly 30 years after their backing in a parliamentary confidence vote paved the way for a government headed by Andrej Babiš, a scandal-tainted billionaire tycoon, amid vehement protests against their return to the political mainstream. The 15 MPs of the Communist party of Bohemia and Moravia (KSCM) provided the votes needed to allow a pact formed between Babiš’ Action of Dissatisfied Citizens (ANO) movement and the Social Democrats (ČSSD) to survive its first test, ending nearly nine months of political stalemate that saw the Czech Republic governed by temporary administrations. The vote - shortly after 1am local time on Thursday - followed a marathon debate lasting more than 12 hours in which opposition MPs voiced fierce opposition to the idea a government reliant on Communist support and questioned Babiš’ fitness to govern in the face of criminal allegations against him. Protests took place outside the parliament building and one conservative opposition party, Top 09, staged a symbolic walkout. In the end, 105 MPs in the 200-member chamber voted for the new government. One leading Social Democrat, Milan Chovanec, a former interior minister, declined to give his backing, citing his conscience. The show of support came after the communists signed a deal with ANO agreeing to “tolerate” the new government – overriding ideological misgivings about Babiš’ wealthy status in exchange for having some policy pledges adopted and being given influential roles in public utilities. Although the party will formally remain outside the coalition, the agreement marks a return to influence and responsibility for the first time since the 1989 Velvet Revolution that ended the communists’ 41-year rule of the former Czechoslovakia. MPs from a conservative opposition party, Top 09, walked out in protest before Wednesday’s vote, while members of the right-wing Christian Democrat party unfurled a banner featuring Soviet red star in a vivid sign of enduring anti-communist feeling in the country. Demonstrations have been staged in Prague and other cities against the rehabilitation of a party still remembered bitterly for its totalitarian methods and ruthless clampdown on dissent during the cold war. “For many people who support right-of-centre parties, this is a big moral and psychological problem, because they see it in symbolic terms and feel it’s not right,” said Jiří Pehe, director of New York University’s campus in Prague and a Czech political analyst. Babiš, who was sworn in as prime minister for a second time last month, disregarded such qualms after more moderate parties declined to serve under him because he faces criminal fraud charges over allegations that he falsely obtained nearly €2m of EU funds for his giant agrochemical business a decade ago. He denies the charges, which he has called politically motivated. Babiš, the Czech Republic’s second-richest man, has also been tarred with a communist past after being named as a former secret police agent when he worked for a Czechoslovak trading company, a charge he disputes. He won communist support for his coalition by agreeing to tax church property that had been restored to it after being seized while the party was in power. However, he has resisted their demands to dilute the Czech Republic’s commitments to Nato, knocking back its demand to cut troop deployments to the Baltic republics and Afghanistan. Babiš’ previous caretaker administration also angered the communists – considered close to the government of Russia’s president, Vladimir Putin – by expelling three of Moscow’s diplomats in solidarity with Britain over the poisoning of the former Russian spy Sergei Skripal and his daughter Yulia in Salisbury. “Babiš has done all this because he feels he doesn’t have democratic legitimacy and is suspected of not being a true liberal democrat,” said Pehe. “He wants to look pro-western, pro-Nato and pro-EU – and he’s made it clear to the communists that he’s not going to compromise on that.” But his government is certain to maintain a hardline anti-migrant stance after Miloš Zeman, the populist Czech president, refused to accept the Social Democrats’ nominee for foreign minister, the MEP Miroslav Poche, on the grounds that he was too liberal on immigration.