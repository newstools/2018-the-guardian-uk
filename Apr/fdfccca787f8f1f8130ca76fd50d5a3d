The president of Madrid’s regional government has resigned after video footage emerged of her apparently being caught stealing two tubs of face cream seven years ago. Cristina Cifuentes, one of the most high-profile figures in the conservative People’s party (PP) led by the prime minister, Mariano Rajoy, had been under pressure to quit over allegations that she faked her master’s degree. She said on Wednesday she was stepping down to spare her colleagues and her family any further embarrassment and discomfort. Cifuentes had managed to cling on for weeks and had attempted to shift responsibility for the degree on to the university that awarded it to her, but the release of the video to the news site OKdiario appears to have sealed her fate. Speaking at a hastily convened press conference, Cifuentes said the footage showed nothing more than an “involuntary mistake” she had made in 2011. She said she had become the subject of a very public and very personal “lynching” over recent days and weeks. “This has been a campaign of harassment and demolition and one which has, for a while now, stopped being political and become personal. Some clear red lines have been crossed,” she said. Cifuentes, who had governed that Madrid region since 2015, said she was stepping aside so as not to jeopardise her administration’s achievements or allow her political opponents to take control. Speaking after the resignation, Rajoy said: “Cristina Cifuentes has done what she had to do. I think the situation made her resignation obligatory.” Opposition parties in the regional assembly had called a vote of no confidence in early May. Her departure means the PP can now replace her with another candidate. “The alternative would be a leftist government that would undoubtedly not just raise taxes but also destroy many of the things we’ve done and mean an administration that would be bad for the people of Madrid,” Cifuentes said. She said she had taken the decision to resign a few days earlier and had been planning to announce her departure in early May. She said Wednesday’s events had forced her hand. “I have already endured about 35 days of permanent exposure and lynching morning, noon and night by land, sea and air,” she said. “But what happened today has crossed a line … First of all, I don’t want to hurt my family, which is why I’ve taken this decision – for my family, so that they don’t have to continue suffering. I also believe it’s what’s best for Madrid, for the people of Madrid and, of course, for my party.” Cifuentes’s troubles began on 21 March when El Diario first raised questions over the validity of the master’s degree she had been awarded by King Juan Carlos University in Madrid. She threatened to sue the site and later gave up the qualification. It subsequently emerged that Pablo Casado, an MP and the PP’s deputy communications chief, had claimed to hold a postgraduate degree from Harvard University but had earned the qualification after attending a four-day course in Madrid. The video leaked to OKdiario appears to show Cifuentes emptying out her bag in the office of a Madrid supermarket to reveal two jars of Olay cream – worth about €40 – which she then pays for. The editor of OKdiario, Eduardo Inda, dismissed suggestions that the footage had been leaked by Cifuentes’s own party in an attempt to force her out and to hold on to power in the region. “The person who gave us the video had nothing to do with either the PP or politics,” Inda told the Spanish TV programme Al Rojo Vivo. Like the PP nationally, the Madrid branch of the party has been mired in a series of corruption scandals. One of Cifuentes’s predecessors, Esperanza Aguirre, resigned as head of the regional party two years ago, admitting “corruption is killing us”. Rajoy had refused to heed calls to sack Cifuentes. Last summer he became the first serving Spanish prime minister to testify in a criminal case, relating to an illegal funding racket within the PP.