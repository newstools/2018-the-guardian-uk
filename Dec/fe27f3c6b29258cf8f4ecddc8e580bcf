MPs have passed a historic motion to hold the government in contempt over its failure to release the cabinet legal advice on the Brexit deal. The Commons leader, Andrea Leadsom, said the government would comply and publish the advice in full on Wednesday.The vote is an unprecedented move in recent political history, in the midst of five days of debate leading up to the final vote on her Brexit deal next week. In a knife-edge vote, MPs voted by 311 votes to 293 to find the government in contempt of parliament, for failure to comply with a Commons motion in November that ordered it to release the advice in full. The attorney general, Geoffrey Cox, had argued that the public interest did not permit the publication of the advice and instead published a summary of the advice and took questions in the House of Commons on Monday. However, the shadow Brexit secretary, Keir Starmer, said the government was “wilfully refusing” to comply with a binding order to release the legal advice on its Brexit deal, putting it in contempt of parliament. He was backed by opposition parties including the Democratic Unionist party, whose votes the government relies on for a majority. The government had attempted to dodge the contempt motion by putting down an amendment seeking to refer the matter to the Commons privileges committee, an attempt to kick it into the long grass. That was defeated by just four votes. Several rebellious Tory MPs including Rees-Mogg and the former attorney general Dominic Grieve expressed some discomfort with the government’s position, but said they would vote for Leadsom’s amendment. However, it was not enough to save the government from defeat by opposition parties and the DUP. During the debate,Starmer said Coxhad “as good as admitted” he was ignoring a parliamentary vote to release the document, because he believed it was not in the national interest. “I’m sorry, that’s a plea of mitigation and not a defence,” Starmer said. “For the attorney general to say in his view that it is not in the national interest is not good enough,” he said. He quoted the Conservative Eurosceptic Jacob Rees-Mogg, who previously said it was “no longer a matter for this government to judge, it has been decided by this house, which is a higher authority”. Starmer said the government had decided not to oppose the original motion on releasing the advice in order to avoid the “short-term humiliation” of a defeat. “The decision taken not to oppose was a political decision because it feared it would lose the vote,” he said. “The price of that was higher than voting against the order … for months the government has ignored opposition day debates and now it has got them into very deep water indeed.” Earlier, Cox insisted he could not comply with MPs’ demand to release the full Brexit legal advice. In a letter to the Commons Speaker, John Bercow, released on Tuesday, Cox said the demand in the original motion was “extremely vague” and impossible for him to fulfil. In his letter, Cox said Bercow must urgently clarify what “possible consequences would follow if the motion was carried”. Cox said the language of Starmer’s demand left “considerable uncertainty” about what Starmer was demanding. “One difficulty the government faces is that the terms of this amended request are themselves extremely vague and it is not clear what is meant by them,” he said. “Unless there is clarity on these questions it is simply not possible for the government to know how to comply with the motion. It is particularly important that if anyone is to face sanctions for contempt, he or she should fairly know how to comply with it.” Cox said the summary provided to MPs in lieu of the full advice hadhis “oversight and approval”. He said his answers to MPs in the Commons chamber were as valid as his advice to cabinet. “I have confirmed that I would have given no different advice to any party who sought it,” he said. “I would respectfully suggest that the government has gone out of its way, while seeking to reconcile the public interest in the law officers’ convention, to satisfy the motion.” Bercow had declared on Monday night that there was “an arguable case that a contempt has been committed” after Labour and others complained that the summary released on Monday did not constitute the final and full advice provided to the cabinet. Earlier, Theresa May had told cabinet it was a longstanding convention that “neither the fact nor the content of law officers’ advice is shared outside government without their consent”. Such is the government’s frustration at Tuesday’s wrangle, that Leadsom has written to the chair of the privileges committee, Kate Green, calling for an inquiry. According to the prime minister’s spokesman, Leadsom’s letter said: “The government is concerned that the recent use of motions by humble address undermine good government in the national interest.” She added that the government feared Labour’s recent approach – which was used to force the government to publish economic assessments of Brexit, as well as in the current row – would “impact the ability of current and future governments to request and receive the best advice”. Leadsom said the privileges committee was in a good position to carry out a “detailed inquiry”.